//Runs only on Tealium link events for video interactions.
// Ensures contentID is present before extracting media_id.

(function (a, b) {

  // Only run on link events where event_name === "video"
  if (a !== "link" || !b || b.event_name !== "video") {
    return;
  }

  // Get contentID from data layer
  var cid = b.contentID || utag.data.contentID;

  // Validate contentID
  if (!cid || typeof cid !== "string") return;

  // Clean stray quotes/spaces
  cid = cid.trim().replace(/^\"+|\"+$/g, "");
  
  // Always set media_type for video events (keeps legacy behavior for non-live)
  if (cid.indexOf("personalstream") > -1) {
    b.media_type = "video : 24/7 live";
    } else {
      b.media_type = "video"; // keep existing value so reports donâ€™t change
    }
    utag.data.media_type = b.media_type;

  
  var mediaID;

  // Extract media ID based on content-discovery pattern
  if (cid.indexOf("content-discovery") > -1) {
    mediaID = cid.split("/")[4] || "";
  } else {
    mediaID = cid.split("/")[3] || "";
  }
  
  // set media_id on the event object
  b.media_id = mediaID;
  
  //also set it on global
  utag.data.media_id = mediaID

})(a, b);